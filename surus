bool isAPressed = false; // Başlangıçta kapalı
bool isBPressed = false; // Başlangıçta kapalı

/**
 * Runs the operator control code. This function will be started in its own task
 * with the default priority and stack size whenever the robot is enabled via
 * the Field Management System or the VEX Competition Switch in the operator
 * control mode.
 *
 * If no competition control is connected, this function will run immediately
 * following initialize().
 *
 * If the robot is disabled or communications is lost, the
 * operator control task will be stopped. Re-enabling the robot will restart the
 * task, not resume it from where it left off.
 */
void opcontrol() {
  // This is preference to what you like to drive on
  chassis.drive_brake_set(MOTOR_BRAKE_COAST);

  while (true) {
    // Gives you some extras to make EZ-Template ezier
    ez_template_extras();

    //chassis.opcontrol_tank();  // Tank control
    chassis.opcontrol_arcade_standard(ez::SPLIT);   // Standard split arcade
    // chassis.opcontrol_arcade_standard(ez::SINGLE);  // Standard single arcade
    // chassis.opcontrol_arcade_flipped(ez::SPLIT);    // Flipped split arcade
    // chassis.opcontrol_arcade_flipped(ez::SINGLE);   // Flipped single arcade
      
      if (master.get_digital_new_press(DIGITAL_A)) {
      isAPressed = !isAPressed; // True ise False, False ise True yap
    }

    // B tuşuna yeni basıldı mı?
    if (master.get_digital_new_press(DIGITAL_B)) {
      isBPressed = !isBPressed; // True ise False, False ise True yap
    }


    // --- INTAKE HAREKET MANTIĞI ---

    if (master.get_digital(DIGITAL_R1)) {
      // --- R1 Basılıyken ---
      
      // Üst Intake: A moduna göre yön seç
      if (isAPressed) {
        intakeUst.move(-127); // Ters
      } else {
        intakeUst.move(127);  // Düz
      }

      // Alt Intake: B modu açıksa çalıştır
      if (isBPressed) {
        intakeAlt.move(127);
      } else {
        intakeAlt.move(0);
      }

      // Orta Intake: Hep ileri
      intakeOrta.move(127);

    } 
    else if (master.get_digital(DIGITAL_L1)) { // L2 yerine L1 kullandım (orijinal koduna göre)
      // --- L1 Basılıyken ---

      // Üst Intake: A modunun tam tersi hareket
      if (isAPressed) {
        intakeUst.move(127);  // Düz
      } else {
        intakeUst.move(-127); // Ters
      }

      // Alt Intake: B modu açıksa çalıştır
      if (isBPressed) {
        intakeAlt.move(127);
      } else {
        intakeAlt.move(0);
      }

      // Orta Intake: Hep geri
      intakeOrta.move(-127);
    } 
    else {
      // --- Hiçbir şeye basılmıyorsa DUR ---
      intakeUst.move(0);
      intakeOrta.move(0);
      intakeAlt.move(0);
    }
    // . . .
    // Put more user control code here!
    // . . .

    pros::delay(ez::util::DELAY_TIME);  // This is used for timer calculations!  Keep this ez::util::DELAY_TIME
  }
}
